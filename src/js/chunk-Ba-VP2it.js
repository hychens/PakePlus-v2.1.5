function t(t){return"string"==typeof t?`'${t}'`:(new r).serialize(t)}const r=function(){class t{#t=new Map;compare(t,r){const e=typeof t,n=typeof r;return"string"===e&&"string"===n?t.localeCompare(r):"number"===e&&"number"===n?t-r:String.prototype.localeCompare.call(this.serialize(t,!0),this.serialize(r,!0))}serialize(t,r){if(null===t)return"null";switch(typeof t){case"string":return r?t:`'${t}'`;case"bigint":return`${t}n`;case"object":return this.$object(t);case"function":return this.$function(t)}return String(t)}serializeObject(t){const r=Object.prototype.toString.call(t);if("[object Object]"!==r)return this.serializeBuiltInType(r.length<10?`unknown:${r}`:r.slice(8,-1),t);const e=t.constructor,n=e===Object||void 0===e?"":e.name;if(""!==n&&globalThis[n]===e)return this.serializeBuiltInType(n,t);if("function"==typeof t.toJSON){const r=t.toJSON();return n+(null!==r&&"object"==typeof r?this.$object(r):`(${this.serialize(r)})`)}return this.serializeObjectEntries(n,Object.entries(t))}serializeBuiltInType(t,r){const e=this["$"+t];if(e)return e.call(this,r);if("function"==typeof r?.entries)return this.serializeObjectEntries(t,r.entries());throw new Error(`Cannot serialize ${t}`)}serializeObjectEntries(t,r){const e=Array.from(r).sort((t,r)=>this.compare(t[0],r[0]));let n=`${t}{`;for(let i=0;i<e.length;i++){const[t,r]=e[i];n+=`${this.serialize(t,!0)}:${this.serialize(r)}`,i<e.length-1&&(n+=",")}return n+"}"}$object(t){let r=this.#t.get(t);return void 0===r&&(this.#t.set(t,`#${this.#t.size}`),r=this.serializeObject(t),this.#t.set(t,r)),r}$function(t){const r=Function.prototype.toString.call(t);return"[native code] }"===r.slice(-15)?`${t.name||""}()[native]`:`${t.name}(${t.length})${r.replace(/\s*\n\s*/g,"")}`}$Array(t){let r="[";for(let e=0;e<t.length;e++)r+=this.serialize(t[e]),e<t.length-1&&(r+=",");return r+"]"}$Date(t){try{return`Date(${t.toISOString()})`}catch{return"Date(null)"}}$ArrayBuffer(t){return`ArrayBuffer[${new Uint8Array(t).join(",")}]`}$Set(t){return`Set${this.$Array(Array.from(t).sort((t,r)=>this.compare(t,r)))}`}$Map(t){return this.serializeObjectEntries("Map",t.entries())}}for(const r of["Error","RegExp","URL"])t.prototype["$"+r]=function(t){return`${r}(${t})`};for(const r of["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"])t.prototype["$"+r]=function(t){return`${r}[${t.join(",")}]`};for(const r of["BigInt64Array","BigUint64Array"])t.prototype["$"+r]=function(t){return`${r}[${t.join("n,")}${t.length>0?"n":""}]`};return t}();function e(r,e){return r===e||t(r)===t(e)}export{e as i};
